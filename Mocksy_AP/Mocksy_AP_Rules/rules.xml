<?xml version="1.0" encoding="UTF-8"?>
<rules xmlns="http://mocksy.org/RULESET/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://mocksy.org/RULESET/1.0.0 http://mocksy.org/schema/mocksy-ruleset-1.0.0.xsd">
	
	<rule id="WebScr" ruleset="WebScr/rules_webscr.xml">
		<match>.*/webscr.*</match>
	</rule>
	
	<rule id="AdaptiveAPI_INVALID_USERID" file="err_template.nvp">
		<not-match header="X-PAYPAL-SECURITY-USERID">.+</not-match>
		<filter class="org.mocksy.filter.PropertyFilter">
			<errorId>500000</errorId>
			<message>Authentication failed.API credentials are incorrect.</message>
		</filter>						
	</rule>
		
	<rule id="AdaptiveAPI_INVALID_SIGNATURE" file="err_template.nvp">
		<not-match header="X-PAYPAL-SECURITY-SIGNATURE">.+</not-match>
		<filter class="org.mocksy.filter.PropertyFilter">
			<errorId>500000</errorId>
			<message>Authentication failed.API credentials are incorrect.</message>
		</filter>						
	</rule>	
		
	<rule id="INVALID_DATA_FORMAT_REQUEST" file="err_template.nvp">
		<not-match header="X-PAYPAL-REQUEST-DATA-FORMAT">NV|SOAP|JSON</not-match>
		<filter class="org.mocksy.filter.PropertyFilter">
			<errorId>500000</errorId>
			<message>Internal Error</message>
		</filter>		
	</rule>
	
	<rule id="INVALID_DATA_FORMAT_RESPONSE" file="err_template.nvp">
		<not-match header="X-PAYPAL-RESPONSE-DATA-FORMAT">NV|SOAP|JSON</not-match>
		<filter class="org.mocksy.filter.PropertyFilter">
			<errorId>500000</errorId>
			<message>Internal Error</message>
		</filter>		
	</rule>

	<rule id="INVALID_APP_ID" file="err_template.nvp">
		<not-match header="X-PAYPAL-APPLICATION-ID">.+</not-match>
		<filter class="org.mocksy.filter.PropertyFilter">
			<errorId>560022</errorId>
			<message>The X-PAYPAL-APPLICATION-ID header contains an invalid value</message>
		</filter>		
	</rule>	
	
	<default-rule ruleset="AdaptivePayments/rules_adaptive.xml" />

</rules>
